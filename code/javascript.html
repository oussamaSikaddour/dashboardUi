<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <title>JavaScript | DashboardUi</title>

    <link rel="icon" type="image/icon" href="assets/img/Logo.ico" />
  </head>
  <body>
    <!-- HEADER -->
    <header class="header">
      <nav class="nav" aria-labelledby="main-nav">
        <h2 id="main-nav" class="sr-only">Main navigation</h2>
        <div class="nav__addons" role="menubar">
          <a
            class="nav__logo"
            href="index.html"
            tabindex="0"
            aria-label="Description of the overall image"
          >
            <img src="assets/img/Logo.png" alt="app Logo" />
          </a>
        </div>
      </nav>
    </header>

    <!-- PHONE NAV TOGGLE -->
    <button
      id="showPhoneNav-btn"
      class="button nav__humb"
      aria-expanded="false"
      aria-controls="options"
      aria-label="Show phone navigation"
      aria-labelledby="showPhoneNav-btn"
    >
      <span></span>
      <span></span>
    </button>

    <!-- PHONE NAV -->
    <nav class="nav--phone" aria-labelledby="main-nav-phone">
      <h2 id="main-nav-phone" class="sr-only">Main navigation for phone</h2>
      <ul class="nav__items" id="options" hidden>
        <li class="nav__item" role="none">
          <a
            class="nav__link"
            href="index.html"
            aria-current="page"
            tabindex="0"
            role="menuitem"
            >Home</a
          >
        </li>
      </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="container container--fit">

<section class="section">
  <h1>üöÄ JavaScript integration</h1>


  <p>
    This group of scripts handles the initialization and dynamic loading of all UI components in the
    application. It ensures that modules are only imported when needed (based on DOM presence) and
    manages a global loading indicator to improve perceived performance during startup.
  </p>

  <h3>üì¶ Overview of Main Files</h3>
  <ul>
    <li><code>main.js</code> ‚Äì entry point that runs on <code>DOMContentLoaded</code>.</li>
    <li><code>Loader.js</code> ‚Äì creates, shows, and hides a full-screen loading animation.</li>
    <li><code>initUIComponents.js</code> ‚Äì dynamically imports UI modules based on their DOM selectors.</li>
    <li><code>LoadModule.js</code> ‚Äì manages caching, importing, and executing exported functions from modules.</li>
  </ul>

  <h3>‚öôÔ∏è 1. Application Entry (main.js)</h3>
  <p>
    The main script waits for the DOM to be ready, then shows a loader, initializes UI modules asynchronously,
    and hides the loader when everything is ready.
  </p>
  <pre><code class="language--js">
import { createLoader, showLoader, hideLoader } from './components/Loader.js';

import { initUIComponents } from './utils/initUIComponents.js';


document.addEventListener('DOMContentLoaded', async () => {

  createLoader();

  showLoader();

  await initUIComponents();

  hideLoader();

});

</code></pre>

  <ul>
    <li><strong>Step 1:</strong> <code>createLoader()</code> builds the loader HTML if not already present.</li>
    <li><strong>Step 2:</strong> <code>showLoader()</code> displays the animated loader overlay.</li>
    <li><strong>Step 3:</strong> <code>initUIComponents()</code> dynamically loads and executes UI modules.</li>
    <li><strong>Step 4:</strong> <code>hideLoader()</code> hides the loader and focuses the first visible form input.</li>
  </ul>

  <h3>üåÄ 2. Loader Management (Loader.js)</h3>
  <p>
    The loader provides visual feedback during page initialization. It consists of two animated circles created dynamically via JavaScript.
  </p>
  <pre><code class="language--js">
export function createLoader() {

  if (loaderContainer) return;

  loaderContainer = document.createElement('div');

  loaderContainer.className = 'loader__container';

  loaderContainer.innerHTML = '&lt;div class="loader"&gt;...&lt;/div&gt;';

  document.body.appendChild(loaderContainer);

}

export function showLoader() {

  if (!loaderContainer) createLoader();

  loaderContainer.classList.add('show');

}

export function hideLoader() {

  loaderContainer.classList.remove('show');

  const form = document.querySelector('.form');

  if (form) focusNonHiddenInput(form);

}
</code></pre>

  <ul>
    <li><strong>createLoader:</strong> Builds a <code>&lt;div&gt;</code> structure with two animated circles.</li>
    <li><strong>showLoader:</strong> Adds a <code>.show</code> class to make the loader visible.</li>
    <li><strong>hideLoader:</strong> Removes the <code>.show</code> class and restores focus to the first usable form field.</li>
    <li>It imports <code>focusNonHiddenInput</code> from <code>Form.js</code> to improve accessibility after loading.</li>
  </ul>

  <h3>üß© 3. Dynamic Component Initialization (initUIComponents.js)</h3>
  <p>
    This script scans the DOM for specific selectors and dynamically imports the corresponding JS component modules only if those elements exist. It uses a configuration array named <code>UI_MODULES</code>.
  </p>
  <pre><code class="language--js">
    
const UI_MODULES = [

  {
    selector: ".tooltip",
    fileName: "Tooltip",
    exports: [
      { exportType: "default", functionName: "Tooltip", functionArguments: [] }
    ]
  },

  {
    selector: ".form",
    fileName: "Form",
    exports: [
      { exportType: "named", functionName: "focusNonHiddenInput" },
      { exportType: "named", functionName: "clearErrorsOnFocus" },
      { exportType: "named", functionName: "slide" }
    ]
  }

  // ... more UI modules

];

export const initUIComponents = async () => {

  const loadPromises = UI_MODULES
    .filter(config => document.querySelector(config.selector))
    .map(config => loadModule(config.fileName, config.exports));
  return Promise.all(loadPromises);

};

</code></pre>

  <ul>
    <li>Each entry defines the <code>selector</code>, <code>fileName</code>, and exported functions to initialize.</li>
    <li>Only modules that correspond to visible DOM elements are imported.</li>
    <li>It uses <code>loadModule()</code> (from <code>LoadModule.js</code>) to handle caching and function execution.</li>
  </ul>

  <h3>üß† 4. Module Loader and Cache (LoadModule.js)</h3>
  <p>
    This utility handles the dynamic import logic, function execution, and error handling for all UI components. It ensures that once a module is loaded, it‚Äôs cached to prevent duplicate imports.
  </p>

  <h4>üóÉÔ∏è Module Cache</h4>
  <pre><code class="language--js">
    
    const moduleCache = new Map();

const getCachedModule = (fileName) => moduleCache.get(fileName);
const setCachedModule = (fileName, module) => moduleCache.set(fileName, module);
const isModuleCached = (fileName) => moduleCache.has(fileName);

</code>

</pre>

  <ul>
    <li>Modules are stored in <code>Map</code> to prevent re-importing the same file multiple times.</li>
    <li><code>getCachedModule()</code>, <code>setCachedModule()</code>, and <code>isModuleCached()</code> manage the cache state.</li>
  </ul>

  <h4>üì• Module Import</h4>
  <pre><code class="language--js" >
   
 const importModule = async (fileName) => {

  const module = await import(`../components/${fileName}.js`);

  setCachedModule(fileName, module);

  return module;

};
</code></pre>

  <ul>
    <li>Dynamically imports ES modules from the <code>/components</code> directory.</li>
    <li>Stores imported modules in the cache automatically.</li>
  </ul>

  <h4>üîç Function Resolution & Execution</h4>
  <pre><code class="language--js">

    const resolveFunction = (module, exportType, functionName) => {

  return exportType === "default" ? module.default : module[functionName];

};

const executeFunction = (fn, args, label) => {
  const result = fn(...args);
  return { label, result, success: true };
};
</code></pre>

  <ul>
    <li>Resolves whether a function is exported as default or named.</li>
    <li>Safely executes the function with provided arguments, logging any errors in a structured report.</li>
  </ul>

  <h4>üìä Reporting</h4>

  <pre><code class="language--js">
    
const createInitialReport = (fileName) => ({
  fileName,
  succeeded: false,
  results: [],
  errors: []
});
</code></pre>

  <ul>
    <li>Each load operation produces a structured report summarizing which functions ran successfully.</li>
    <li>Any import or runtime error is logged for debugging and diagnostics.</li>
  </ul>

  <h3>‚úÖ Summary</h3>
  <ul>
    <li><strong>main.js:</strong> Orchestrates app boot and shows loader.</li>
    <li><strong>Loader.js:</strong> Handles visual loading state and form focus restoration.</li>
    <li><strong>initUIComponents.js:</strong> Scans DOM and imports modules dynamically.</li>
    <li><strong>LoadModule.js:</strong> Handles caching, importing, and executing exports safely.</li>
  </ul>

  <p>
    Together, these files create a scalable, performant, and modular startup system for your frontend. Each UI feature is
    imported only when required, improving load time and maintainability.
  </p>
  <p> here you can find the entigrety of the files </p>

  <h2>
    main.js
  </h2>
  <pre>
    <code class="language--js">
import { createLoader, showLoader, hideLoader } from './components/Loader.js';

import { initUIComponents } from './utils/initUIComponents.js';


// --- Boot on DOM Ready ---

document.addEventListener('DOMContentLoaded', async () => {

  createLoader();
  showLoader();

  // 3 Load UI modules
  await initUIComponents();

  // 4 UI ready ‚Üí hide loader
  hideLoader();

});

        
    </code>
  </pre>

  <h2>
   loader.js
  </h2>
  <pre>
    <code class="language--js">

// Import helper to focus the first non-hidden input in a form
import { focusNonHiddenInput } from './Form.js';

let loaderContainer = null;

export function createLoader() {
  if (loaderContainer) return; // Prevent creating duplicates

  loaderContainer = document.createElement('div');
  loaderContainer.className = 'loader__container';

  const loader = document.createElement('div');
  loader.className = 'loader l';

  loader.innerHTML = `

    &lt;div class="loader__circle"&gt;&lt;/div&gt;
    &lt;div class="loader__circle"&gt;&lt;/div&gt;

  `;

  loaderContainer.appendChild(loader);

  document.body.appendChild(loaderContainer);

}

export function showLoader() {

  if (!loaderContainer) createLoader();

  loaderContainer.classList.add('show');

}

export function hideLoader() {

  if (!loaderContainer) return;

  loaderContainer.classList.remove('show');


  // after loader hides, focus first usable form input
  const form = document.querySelector('.form');
  if (form) focusNonHiddenInput(form);

}

    </code>
  </pre>
  <h2>
    initUIComponents.js
  </h2>
  <pre>
    <code class="language--js">

import { loadModule } from "./LoadModule.js";

/**
 * Configuration for UI modules to dynamically import.
 * Each object contains:
 *  - selector: DOM element to check for existence
 *  - fileName: module file to import
 *  - exports: array of exported functions to call with arguments
 */
const UI_MODULES = [
  {
    selector: ".tooltip",
    fileName: "Tooltip",
    exports: [
      { exportType: "default", functionName: "Tooltip", functionArguments: [] }
    ]
  },
  {
    selector: ".nav",
    fileName: "Header",
    exports: [
      { exportType: "default", functionName: "Navigation", functionArguments: [] }
    ]
  },
  {
    selector: ".modal",
    fileName: "Modal",
    exports: [
      { exportType: "default", functionName: "Modal", functionArguments: [] }
    ]
  },
  {
    selector: ".lang__menu__container",
    fileName: "Lang",
    exports: [
      { exportType: "default", functionName: "Lang", functionArguments: [] }
    ]
  },
  {
    selector: ".radio__group > .choices",
    fileName: "RadioInput",
    exports: [
      { exportType: "named", functionName: "manageRadioInputs", functionArguments: [document.querySelectorAll('.radio__group > .choices')] }
    ]
  },
  {
    selector: ".checkbox__group > .choices",
    fileName: "CheckBoxes",
    exports: [
      { exportType: "named", functionName: "manageCheckBoxes", functionArguments: [document.querySelectorAll('.checkbox__group > .choices')] }
    ]
  },
  {
    selector: ".file__input__item",
    fileName: "FileInputs",
    exports: [
      { exportType: "default", functionName: "manageFileInputs", functionArguments: [] }
    ]
  },
  {
    selector: ".sidebar",
    fileName: "sidebar",
    exports: [
      { exportType: "default", functionName: "Sidebar", functionArguments: [] }
    ]
  }
  ,
  {
    selector: ".accordion",
    fileName: "Accordion",
    exports: [
      { exportType: "default", functionName: "Accordion", functionArguments: [] }
    ]
  }
  ,
  {
    selector: ".dialog",
    fileName: "Dialog",
    exports: [
      { exportType: "default", functionName: "Dialog", functionArguments: [] }
    ]
  }
  ,
  {
    selector: ".errors__container",
    fileName: "ErrorsNotifications",
    exports: [
      { exportType: "default", functionName: "ErrorsNotifications", functionArguments: [] }
    ]
  }
  ,
  {
    selector: ".toast__container",
    fileName: "Toast",
    exports: [
      { exportType: "default", functionName: "Toast", functionArguments: [] }
    ]
  },
  {
    selector: ".form",
    fileName: "Form",
    exports: [
      { exportType: "named", functionName: "focusNonHiddenInput", functionArguments: [] },
      { exportType: "named", functionName: "clearErrorsOnFocus", functionArguments: [] },
      // { exportType: "named", functionName: "slide", functionArguments: [['slide-register-form-step']] },
      { exportType: "named", functionName: "slide", functionArguments: [] },
    ]
  },
  {
    selector: "progress",
    fileName: "CustomProgress",
    exports: [
      { exportType: "default", functionName: "CustomProgress", functionArguments: [] },
      { exportType: "named", functionName: "TestCustomProgress", functionArguments: [] },

    ]
  },
  {
    selector: ".combobox__input",
    fileName: "Combobox",
    exports: [
      { exportType: "default", functionName: "Combobox", functionArguments: [] },
    ]
  },
  {
    selector: ".tabs__container",
    fileName: "Tabs",
    exports: [
      { exportType: "default", functionName: "Tabs", functionArguments: [] },
    ]
  }
  ,
  {
    selector: ".table__container",
    fileName: "Table",
    exports: [
      { exportType: "default", functionName: "Table", functionArguments: [] },
    ]
  }
];

/**
 * Initializes all UI components dynamically based on DOM presence.
 */
export const initUIComponents = async () => {
  const loadPromises = UI_MODULES
    .filter(config => document.querySelector(config.selector)) // Only load if element exists
    .map(config => loadModule(config.fileName, config.exports));

  return Promise.all(loadPromises);
};



    </code>
  </pre>


    <h2>
    LoadModule.js
  </h2>
  <pre>
    <code class="language--js">
const moduleCache = new Map();

// Cache Management
const getCachedModule = (fileName) => {
  return moduleCache.get(fileName);
};

const setCachedModule = (fileName, module) => {
  moduleCache.set(fileName, module);
};

const isModuleCached = (fileName) => {
  return moduleCache.has(fileName);
};

// Module Import
const importModule = async (fileName) => {
  try {
    const module = await import(`../components/${fileName}.js`);
    setCachedModule(fileName, module);
    return module;
  } catch (error) {
    throw new Error(`Failed to import "/components/${fileName}.js": ${error.message}`);
  }
};

 export const loadModuleFromCacheOrImport = async (fileName) => {
  if (isModuleCached(fileName)) {
    return getCachedModule(fileName);
  }
  return await importModule(fileName);
};

// Function Resolution
const resolveFunction = (module, exportType, functionName) => {
  if (exportType === "default") {
    return module.default;
  }
  return module[functionName];
};

const getFunctionLabel = (fileName, exportType, functionName) => {
  if (exportType === "default") {
    return `${fileName}#default`;
  }
  return `${fileName}#${functionName}`;
};

const validateFunction = (fn, label) => {
  if (typeof fn !== "function") {
    throw new Error(`Function not found or not callable: ${label}`);
  }
};

// Function Execution
const executeFunction = (fn, functionArguments, label) => {
  try {
    const result = fn(...functionArguments);
    return { label, result, success: true };
  } catch (error) {
    throw new Error(`Error executing ${label}: ${error.message}`);
  }
};

const processExportEntry = async (module, fileName, entry) => {
  const { exportType = "named", functionName, functionArguments = [] } = entry;
  
  const label = getFunctionLabel(fileName, exportType, functionName);
  const fn = resolveFunction(module, exportType, functionName);
  
  validateFunction(fn, label);
  return executeFunction(fn, functionArguments, label);
};

// Report Management
const createInitialReport = (fileName) => {
  return { 
    fileName, 
    succeeded: false, 
    results: [], 
    errors: [] 
  };
};

const addResultToReport = (report, result) => {
  report.results.push(result);
};

const addErrorToReport = (report, errorMessage) => {
  report.errors.push(errorMessage);
};

const finalizeReport = (report) => {
  report.succeeded = report.errors.length === 0;
  return report;
};

// Main Export Function
export const loadModule = async (fileName, exports = []) => {
  const report = createInitialReport(fileName);

  try {
    const module = await loadModuleFromCacheOrImport(fileName);

    for (const entry of exports) {
      try {
        const result = await processExportEntry(module, fileName, entry);
        addResultToReport(report, result);
      } catch (error) {
        addErrorToReport(report, error.message);
        console.warn(error.message);
      }
    }

    return finalizeReport(report);
  } catch (error) {
    addErrorToReport(report, error.message);
    console.error(error.message);
    return finalizeReport(report);
  }
};

    </code>
  </pre>
</section>


    
</main>

    <script type="module" src="js/main.js"></script>
  </body>
</html>
