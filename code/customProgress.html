<!DOCTYPE html>
<html lang="en" >
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <title>Custom Progress | DashboardUi</title>
    <link rel="icon" type="image/icon" href="assets/img/logo.ico" />
  </head>

  <body>
    <!-- HEADER -->
    <header class="header">
      <nav class="nav" aria-labelledby="main-nav">
        <h2 id="main-nav" class="sr-only">Main navigation</h2>
        <div class="nav__addons" role="menubar">
          <a
            class="nav__logo"
            href="index.html"
            tabindex="0"
            aria-label="Description of the overall image"
          >
            <img src="assets/img/Logo.png" alt="app Logo" />
          </a>
        </div>
      </nav>
    </header>

    <!-- PHONE NAV TOGGLE -->
    <button
      id="showPhoneNav-btn"
      class="button nav__humb"
      aria-expanded="false"
      aria-controls="options"
      aria-label="Show phone navigation"
      aria-labelledby="showPhoneNav-btn"
    >
      <span></span>
      <span></span>
    </button>

    <!-- PHONE NAV -->
    <nav class="nav--phone" aria-labelledby="main-nav-phone">
      <h2 id="main-nav-phone" class="sr-only">Main navigation for phone</h2>
      <ul class="nav__items" id="options" hidden>
        <li class="nav__item" role="none">
          <a
            class="nav__link"
            href="index.html"
            aria-current="page"
            tabindex="0"
            role="menuitem"
            >Home</a
          >
        </li>
      </ul>
    </nav>

    <main class="container container--fit">
      <div class="column">
        <h1>Custom Progress</h1>

        <div class="row">
          <progress value="75" max="100">75%</progress>
        </div>
      </div>

      <section class="section" id="custom-progress-section">
        <h2>Custom Progress Component</h2>

        <p>
          The <strong>Custom Progress</strong> component provides a visual
          circular progress indicator synchronized with a native
          <code>&lt;progress&gt;</code> element. It dynamically animates
          percentage updates using CSS variables and transitions, while offering
          accessible status updates through ARIA attributes.
        </p>

        <p>
          It can be used to show loading, form submission progress, or
          long-running actions in a clear and attractive way. The circle
          gradually fills up to represent the percentage value, and when
          complete, transforms into a checkmark icon.
        </p>

        <ul>
          <li>
            <strong>.custom__progress</strong> — the circular progress
            container, controlled by the CSS variable <code>--percentage</code>.
          </li>
          <li>
            <strong>.custom__progress__percentage</strong> — inner circle
            showing the numeric percentage or checkmark.
          </li>
          <li>
            <strong>.check-icon</strong> — hidden by default; appears when
            progress reaches 100%.
          </li>
          <li>
            <strong>.completed</strong> — modifier class added when the task is
            finished, switching the circle color and displaying the checkmark.
          </li>
        </ul>

        <p><strong>Example markup:</strong></p>

        <pre><code class="language--html">
&lt;progress value="75" max="100"&gt;75%&lt;/progress&gt;

&lt;div class="custom__progress"
     aria-live="polite"
     aria-busy="true"
     role="progressbar"&gt;

  &lt;div class="custom__progress__percentage"&gt;
    &lt;strong&gt;0 &lt;span&gt;%&lt;/span&gt;&lt;/strong&gt;
    &lt;span class="check-icon"&gt;&lt;i class="fa-solid fa-check"&gt;&lt;/i&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
        </code></pre>

        <p><strong>CSS:</strong></p>

        <pre><code class="language--css">
@property --percentage {
  syntax: "&lt;length-percentage&gt;";
  inherits: false;
  initial-value: 0%;
}

.custom__progress {
  --size: 13.2rem;
  --bar-width: 2rem;
  font-size: 3rem;
  position: fixed;
  bottom: 5rem;
  right: 2.5rem;
  z-index: 200;
  width: var(--size);
  height: var(--size);
  aspect-ratio: 1/1;
  background: conic-gradient(rgb(4.4418, 69.9593, 91.0581) var(--percentage, 0), #087EA4 0%);
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: var(--div-shadow);
  transition: --percentage 500ms;
}

.custom__progress__percentage {
  background-color: #087EA4;
  color: var(--clr-light);
  border-radius: inherit;
  width: calc(100% - var(--bar-width));
  aspect-ratio: 1/1;
  display: flex;
  align-items: center;
  justify-content: center;
}

.custom__progress__percentage strong {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3.5rem;
}

.custom__progress__percentage strong span {
  margin-top: 1rem;
  font-size: 2rem;
}

.custom__progress__percentage .check-icon {
  display: none;
  transform: scale(0);
  font-size: 6rem;
  transition: 0.1s transform ease-in-out;
  transition-delay: 0.1s;
}

.custom__progress.completed .custom__progress__percentage {
  background-color: rgb(4.4418, 69.9593, 91.0581);
}

.custom__progress.completed strong {
  display: none;
}

.custom__progress.completed .check-icon {
  display: block;
  transform: scale(1);
}
        </code></pre>

        <p>
          This CSS defines the <strong>visual appearance</strong> of the
          progress indicator using a <code>conic-gradient</code> that
          dynamically fills based on the <code>--percentage</code> variable.
        </p>

        <ul>
          <li>
            <code>@property --percentage</code> enables smooth transitions for
            the CSS variable driving the circular fill.
          </li>
          <li>
            The outer circle (<code>.custom__progress</code>) changes according
            to
            <code>--percentage</code>, creating an animated sweep.
          </li>
          <li>
            The inner circle (<code>.custom__progress__percentage</code>) holds
            the text and checkmark, maintaining centered alignment.
          </li>
          <li>
            Once progress reaches 100%, the <code>.completed</code> modifier
            changes colors and shows the check icon.
          </li>
        </ul>

        <p><strong>JS:</strong></p>

        <pre><code class="language--js">
// ======================
// Utility Functions
// ======================

function getProgressValue(progressElement) {
  return parseInt(progressElement.value, 10);
}

function setProgressValue(progressElement, value) {
  progressElement.value = value;
}

function updateTextDisplay(customValueElement, value) {
  customValueElement.innerHTML = \`\${value}  &lt;span &gt;% &lt;/span &gt;\`;
}

function updateRotation(customProgressElement, value) {
  customProgressElement.style.setProperty("--percentage", value + "%");
}

function updateStyleClass(customProgressElement, value) {
  if (value >= 0 && value  &lt;= 50) {
    customProgressElement.classList.add("less");
  } else {
    customProgressElement.classList.remove("less");
  }
}

function updateCustomProgress(progressElement, customProgressElement, customValueElement) {
  const value = getProgressValue(progressElement);
  updateTextDisplay(customValueElement, value);
  updateRotation(customProgressElement, value);
  updateStyleClass(customProgressElement, value);
}

// ======================
// Initialization
// ======================

function initializeProgressComponents() {
  const progress = document.querySelector("progress");
  const customProgress = document.querySelector(".custom__progress");
  const customValue = customProgress?.querySelector("strong");

  if (!progress || !customProgress || !customValue) return null;
  return { progress, customProgress, customValue };
}

function monitorProgressCompletion(progressElement, customProgress, customValue) {
  const intervalId = setInterval(() => {
    const currentValue = getProgressValue(progressElement);

    if (currentValue >= 100) {
      setProgressValue(progressElement, 100);
      updateCustomProgress(progressElement, customProgress, customValue);

      customProgress.setAttribute("aria-busy", "false");
      customProgress.classList.add("completed");
      clearInterval(intervalId);
      return;
    }

    updateCustomProgress(progressElement, customProgress, customValue);
    customProgress.classList.remove("completed");
  }, 1000);
}

const CustomProgress = () => {
  const components = initializeProgressComponents();
  if (!components) return;

  document.addEventListener("show-custom-progress", () => {
    const { progress, customProgress, customValue } = components;
    monitorProgressCompletion(progress, customProgress, customValue);
  });
};

export default CustomProgress;
        </code></pre>

        <p>
          The JavaScript module handles the logic for monitoring, updating, and
          completing the progress indicator. It is event-driven for better
          flexibility and separation of responsibilities.
        </p>

        <ul>
          <li>
            <code>getProgressValue</code> and
            <code>setProgressValue</code> manage the numeric value of the native
            progress element.
          </li>
          <li>
            <code>updateRotation</code> adjusts the CSS variable
            <code>--percentage</code> to control the conic gradient.
          </li>
          <li>
            <code>monitorProgressCompletion</code> polls the progress value
            every second, stopping automatically when it reaches 100%.
          </li>
          <li>
            When completed, the circle color changes and the check icon appears
            smoothly.
          </li>
          <li>
            The module listens for a <code>show-custom-progress</code> event,
            which can be triggered from anywhere to start the monitoring logic:
          </li>
        </ul>

        <pre><code class="language--js">
document.dispatchEvent(new CustomEvent("show-custom-progress"));
        </code></pre>

        <p>
          This architecture ensures that visual rendering, accessibility, and
          state management remain modular and reusable across the project.
        </p>

        <p>
          For more information about JavaScript integration, visit the
          documentation
          <a href="javascript.html">[here]</a>.
        </p>
      </section>
    </main>

    <div
      class="custom__progress"
      aria-live="polite"
      aria-busy="true"
      role="progressbar"
    >
      <div class="custom__progress__percentage">
        <strong>0 <span>%</span></strong>
        <span class="check-icon"><i class="fa-solid fa-check"></i></span>
      </div>
    </div>

    <script type="module" src="js/main.js"></script>
  </body>
</html>
