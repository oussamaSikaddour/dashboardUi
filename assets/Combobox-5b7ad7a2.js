import{s as A}from"./Aria-73313eea.js";import{p as x}from"./positioning-35ca2066.js";const I=(t,e)=>{let o;return(...n)=>{clearTimeout(o),o=setTimeout(()=>t==null?void 0:t.apply(globalThis,n),e)}},i=document.querySelector(".combobox__list");let s=null;const h=()=>document.querySelectorAll(".combobox"),v=t=>t.querySelector("button"),g=t=>t.querySelector(".input"),b=t=>Array.from(t.querySelectorAll("li")),k=t=>b(t).filter(e=>!e.classList.contains("hide")),q=t=>t.querySelector("li.active"),w=t=>{const e=t.querySelector("ul[role='listbox']");return e?e.innerHTML.trim():""},p=(t,e)=>{t.innerHTML=e},C=t=>Array.from(t.querySelectorAll("div")).map(e=>e.textContent.trim()).join(" ").toLowerCase(),L=(t,e)=>{var o;return((o=t.querySelectorAll("div")[e-1])==null?void 0:o.textContent.trim())||""},u=(t,e,o)=>{e.value=L(t,2),o.forEach(n=>n.classList.remove("active")),t.classList.add("active"),t.setAttribute("tabindex","0"),t.focus()},T=t=>{b(t).forEach(e=>{e.classList.remove("active"),e.setAttribute("tabindex","-1")})},E=(t,e)=>{const o=t.toLowerCase();let n=!1;b(e).forEach(r=>{const c=C(r).includes(o);r.classList.toggle("hide",!c),c&&(n=!0)}),e.classList.toggle("open",n)},D=(t,e)=>e.indexOf(t),S=(t,e)=>t<e?t+1:0,F=(t,e)=>t>0?t-1:e,z=(t,e,o,n,r,c)=>{const a=k(e);if(!a.length)return;const d=q(e),f=d?D(d,a):-1,m=a.length-1;switch(t.key){case"Escape":case"Enter":case" ":t.preventDefault(),c(!1);break;case"ArrowDown":t.preventDefault(),u(a[S(f,m)],n,a);break;case"ArrowUp":t.preventDefault(),u(a[F(f,m)],n,a);break;case"Home":t.preventDefault(),u(a[0],n,a);break;case"End":t.preventDefault(),u(a[m],n,a);break}},y=(t,e,o,n)=>{if(s&&s.combobox!==t){const{combobox:r,button:c,input:a,state:d}=s;l(r,!1,i,c,a,d)}s={combobox:t,input:e,button:o,state:n}},H=()=>s=null,l=(t,e,o,n,r,c)=>{e?y(t,r,n,c):(s==null?void 0:s.combobox)===t&&H(),o.classList.toggle("show",e),r.setAttribute("aria-expanded",e),n.setAttribute("aria-expanded",e),A(e?"false":"true",e?0:-1,o),c.isShown=e;const a=w(t);a&&(e?(p(o,a),x(r,o,4)):(T(o),p(o,"")))},K=(t,e)=>t.addEventListener("keydown",o=>{if(o.key==="ArrowDown"){o.preventDefault();const n=e.querySelector("li:not(.hide)");n&&u(n,t,b(e))}}),M=t=>{document.addEventListener("focusin",e=>{const o=e.target.closest(".combobox");if(o){const n=g(o),r=v(o),c={isShown:!1};y(o,n,r,c),l(o,!0,t,r,n,c)}}),document.addEventListener("focusout",e=>{if(s&&!s.combobox.contains(e.relatedTarget)&&!t.contains(e.relatedTarget)){const{combobox:o,button:n,input:r,state:c}=s;l(o,!1,t,n,r,c)}})},O=t=>{const e=I(o=>E(o.target.value.trim(),t),300);document.addEventListener("input",o=>{(s==null?void 0:s.input)===o.target&&e(o)}),document.addEventListener("keydown",o=>{(s==null?void 0:s.input)===o.target&&K(o.target,t)})},V=t=>{t.addEventListener("keydown",e=>{if(!s)return;const{input:o,button:n,state:r,combobox:c}=s;z(e,t,n,o,r,a=>l(c,a,t,n,o,r))})};i.addEventListener("click",t=>{if(!s)return;const{combobox:e,input:o,button:n,state:r}=s,c=t.target.closest("li");c&&(o.value=L(c,2),E(o.value,i),l(e,!1,i,n,o,r))});document.addEventListener("click",t=>{if(s&&!i.contains(t.target)&&!s.combobox.contains(t.target)){const{combobox:e,button:o,input:n,state:r}=s;l(e,!1,i,o,n,r)}});const _=t=>{M(t),O(t),V(t)},R=()=>{h().forEach(t=>{const e=g(t),o=v(t),n={isShown:!1};o.addEventListener("click",()=>{l(t,!n.isShown,i,o,e,n)})}),_(i)};export{R as default};
